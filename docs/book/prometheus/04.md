---
prev: ./03.md
next: ./05.md
---

# 监控(抓取)任务

> 在 Prometheus 配置有三大块配置，全局配置、告警规则配置、抓取任务配置

> 其中监控抓取配置在 Prometheus 配置中也属于重要的一块

## 抓取配置

先来看下默认配置文件中的抓取任务

```yml
scrape_configs:
  # The job name is added as a label `job=<job_name>` to any timeseries scraped from this config.
  - job_name: "prometheus"

    # metrics_path defaults to '/metrics'
    # scheme defaults to 'http'.

    static_configs:
      - targets: ["localhost:9090"]
```

再来看下官方关于抓取任务的配置

```yml
scrape_configs:
  - job_name: # 抓取任务的任务名称
    scrape_interval: 15 # 默认是全局配置中scrape_interval的值
    scrape_timeout: 10 # 默认是全局配置中scrape_timeout的值
    metrics_path: /metrics # 目标暴露metrics信息的HTTP路径
    scheme: http # 请求协议，默认是http
    params: [<string>: [<string>, ...]] # 可选的HTTP中URL的参数
    static_configs: # 静态配置
      targets: [- '<host>'] # 抓取目标列表
      labels: [<labelname>: <labelvalue> ...] # 抓取目标实例配置的标签
```

在 Prometheus 中体现如图

![](../asset/scrape_configs.png)

## 服务发现

> 列举常用的几个

- file_sd_config
- dockerswarm_sd_config
- kubernetes_sd_config
