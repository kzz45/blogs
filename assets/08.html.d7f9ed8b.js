import{c as n}from"./app.897a2dcd.js";import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";var a="/blogs/assets/curl_prometheus_auth.f554de08.png";const e={},p=n(`<h1 id="prometheus-\u7684\u8BA4\u8BC1" tabindex="-1"><a class="header-anchor" href="#prometheus-\u7684\u8BA4\u8BC1" aria-hidden="true">#</a> Prometheus \u7684\u8BA4\u8BC1</h1><p>Prometheus \u5176\u5B9E\u6709\u4E09\u79CD\u8BA4\u8BC1\u65B9\u5F0F\uFF0C\u6211\u4EEC\u5B9E\u8DF5\u7684\u662F\u57FA\u7840\u8BA4\u8BC1\uFF0C\u4E5F\u5C31\u662F username \u548C password \u65B9\u5F0F\u7684 basic auth</p><h2 id="\u8BA4\u8BC1\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u8BA4\u8BC1\u6587\u4EF6" aria-hidden="true">#</a> \u8BA4\u8BC1\u6587\u4EF6</h2><p>\u65B0\u5EFA web.yml \u6587\u4EF6</p><p>\u5176\u4E2D\u6211\u4EEC\u8BBE\u5B9A\u7528\u6237\u540D\u548C\u5BC6\u7801\u90FD\u662F admin</p><p>\u4E0D\u8FC7\u5BC6\u7801\u9700\u8981\u52A0\u5BC6\uFF0C\u65B9\u5F0F\u5982\uFF1A</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> bcrypt
password <span class="token operator">=</span> <span class="token string">&quot;admin&quot;</span>
hashed_password <span class="token operator">=</span> bcrypt<span class="token punctuation">.</span>hashpw<span class="token punctuation">(</span>password<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bcrypt<span class="token punctuation">.</span>gensalt<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>hashed_password<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>web.yml</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">basic_auth_users</span><span class="token punctuation">:</span>
  <span class="token key atrule">admin</span><span class="token punctuation">:</span> $2b$12$9xjGU51fYohVBrUHnH4n/ed8Mid4qbSGonIQ1KdlEGNtimRqIFk7K <span class="token comment"># \u5BC6\u7801\u662F\u4E0A\u9762\u65B9\u5F0F\u751F\u6210</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E" aria-hidden="true">#</a> \u914D\u7F6E</h2><p>\u6211\u4EEC\u7A0D\u5FAE\u4FEE\u6539\u4E0B\u57FA\u7840\u914D\u7F6E\u6587\u4EF6</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># \u5168\u5C40\u914D\u7F6E</span>
<span class="token key atrule">global</span><span class="token punctuation">:</span>
  <span class="token key atrule">scrape_interval</span><span class="token punctuation">:</span> 15s
  <span class="token key atrule">scrape_timeout</span><span class="token punctuation">:</span> 15s

<span class="token key atrule">alerting</span><span class="token punctuation">:</span>
  <span class="token key atrule">alertmanagers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span>
<span class="token comment">#            - 127.0.0.1:9093</span>

<span class="token key atrule">rule_files</span><span class="token punctuation">:</span>

<span class="token key atrule">scrape_configs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">job_name</span><span class="token punctuation">:</span> <span class="token string">&quot;local_prom&quot;</span>
    <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;127.0.0.1:9090&quot;</span><span class="token punctuation">]</span>
    <span class="token key atrule">basic_auth</span><span class="token punctuation">:</span>
      <span class="token key atrule">username</span><span class="token punctuation">:</span> admin
      <span class="token key atrule">password</span><span class="token punctuation">:</span> admin
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="\u542F\u52A8\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8\u670D\u52A1" aria-hidden="true">#</a> \u542F\u52A8\u670D\u52A1</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./prometheus <span class="token punctuation">\\</span>
--config.file<span class="token operator">=</span><span class="token string">&quot;prometheus.yml&quot;</span> <span class="token punctuation">\\</span>
--web.config.file<span class="token operator">=</span><span class="token string">&quot;web.yml&quot;</span> <span class="token punctuation">\\</span>
--web.listen-address<span class="token operator">=</span><span class="token string">&quot;0.0.0.0:9090&quot;</span> <span class="token punctuation">\\</span>
--web.enable-lifecycle <span class="token punctuation">\\</span>
--log.level<span class="token operator">=</span>debug
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5" aria-hidden="true">#</a> \u6D4B\u8BD5</h2><p>\u5982\u679C\u6CA1\u6709\u8BA4\u8BC1\u7684\u8BDD\uFF0C\u76F4\u63A5 curl \u672C\u673A\u7684 Prometheus \u670D\u52A1\u7684 metrics \u662F\u76F4\u63A5\u8FD4\u56DE\u4FE1\u606F\u7684</p><p>\u73B0\u5728\u52A0\u4E0A\u8BA4\u8BC1\u7684\u8BDD\uFF0C\u5C31\u9700\u8981\u6307\u5B9A\u7528\u6237\u540D\u548C\u5BC6\u7801\u4E86</p><p><img src="`+a+'" alt=""></p>',18);function t(l,c){return p}var u=s(e,[["render",t]]);export{u as default};
