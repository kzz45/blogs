import{r as e,o as t,a as p,b as s,d as l,F as r,e as n,c as o}from"./app.897a2dcd.js";import{_ as c}from"./plugin-vue_export-helper.21dcd24c.js";var i="/blogs/assets/prometheus_config.1939a3ad.png";const u={},m=s("h1",{id:"prometheus-\u521D\u4F53\u9A8C",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#prometheus-\u521D\u4F53\u9A8C","aria-hidden":"true"},"#"),n(" Prometheus \u521D\u4F53\u9A8C")],-1),b=s("h2",{id:"\u4E0B\u8F7D",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#\u4E0B\u8F7D","aria-hidden":"true"},"#"),n(" \u4E0B\u8F7D")],-1),d=n("\u4E0B\u8F7D\uFF1A"),h={href:"https://prometheus.io/download/",target:"_blank",rel:"noopener noreferrer"},k=n("Download the latest release"),g=o(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">tar</span> xvf prometheus-2.40.1.darwin-arm64.tar.gz
<span class="token builtin class-name">cd</span> prometheus-2.40.1.darwin-arm64
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u914D\u7F6E\u6587\u4EF6</h2><blockquote><p>\u4EE5\u4E0B\u662F Prometheus \u7684\u9ED8\u8BA4\u914D\u7F6E\u6587\u4EF6\uFF0CPrometheus \u542F\u52A8\u7684\u65F6\u5019\u5982\u679C\u4E0D\u6307\u5B9A\u914D\u7F6E\u6587\u4EF6\u53C2\u6570\uFF0C\u5C31\u9ED8\u8BA4\u7528\u5F53\u524D\u76EE\u5F55\u4E0B\u7684\u9ED8\u8BA4\u914D\u7F6E\u6587\u4EF6</p></blockquote><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># \u5168\u5C40\u914D\u7F6E</span>
<span class="token key atrule">global</span><span class="token punctuation">:</span>
  <span class="token key atrule">scrape_interval</span><span class="token punctuation">:</span> 15s <span class="token comment"># \u4EFB\u52A1\u6293\u53D6\u5468\u671F, \u6BCF\u9694\u591A\u5C11\u79D2\u53BB\u5404\u4E2A\u88AB\u76D1\u63A7\u7AEF\u70B9\u62C9\u53D6\u4E00\u6B21\u6307\u6807\u6570\u636E</span>
  <span class="token key atrule">scrape_timeout</span><span class="token punctuation">:</span> 50s <span class="token comment"># \u4EFB\u52A1\u6293\u53D6\u8D85\u65F6\u65F6\u95F4</span>
  <span class="token key atrule">evaluation_interval</span><span class="token punctuation">:</span> 15s <span class="token comment"># \u8BA1\u7B97\u5468\u671F, \u4E3B\u8981\u9488\u5BF9\u4E0B\u9762\u7684\u544A\u8B66\u89C4\u5219, \u6BCF\u9694\u591A\u5C11\u79D2\u6267\u884C\u4E00\u6B21\u8868\u8FBE\u5F0F\u5224\u65AD\u544A\u8B66\u89C4\u5219</span>
  <span class="token key atrule">external_labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">monitor</span><span class="token punctuation">:</span> <span class="token string">&quot;shanghai_1&quot;</span> <span class="token comment"># \u6B64Prometheus\u7684\u6807\u8BC6, \u4F1A\u5728metric\u91CC\u6DFB\u52A0\u8FD9\u5BF9\u6807\u7B7E</span>
  <span class="token key atrule">query_log_file</span><span class="token punctuation">:</span> <span class="token string">&quot;./query_log.log&quot;</span> <span class="token comment"># \u8BB0\u5F55PromQL\u67E5\u8BE2\u65E5\u5FD7</span>

<span class="token comment"># \u544A\u8B66\u914D\u7F6E</span>
<span class="token key atrule">alerting</span><span class="token punctuation">:</span>
  <span class="token key atrule">alertmanagers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> alertmanager<span class="token punctuation">:</span><span class="token number">9093</span> <span class="token comment"># Alertmanager\u7684\u670D\u52A1\u7AEF</span>

<span class="token comment"># \u544A\u8B66\u89C4\u5219\u914D\u7F6E</span>
<span class="token key atrule">rule_files</span><span class="token punctuation">:</span>
  <span class="token comment"># - &quot;first_rules.yml&quot; # \u544A\u8B66\u89C4\u5219\u7684\u914D\u7F6E\u6587\u4EF6</span>
  <span class="token comment"># - &quot;second_rules.yml&quot;</span>

<span class="token comment"># \u6293\u53D6\u914D\u7F6E</span>
<span class="token key atrule">scrape_configs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">job_name</span><span class="token punctuation">:</span> <span class="token string">&quot;prometheus&quot;</span> <span class="token comment"># \u6293\u53D6\u4EFB\u52A1\u7684\u4EFB\u52A1\u540D\u79F0</span>
    <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;localhost:9090&quot;</span><span class="token punctuation">]</span> <span class="token comment"># \u6293\u53D6\u4EFB\u52A1\u7684\u4E0B\u9762\u7684\u76EE\u6807\u5B9E\u4F8B</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>\u5728 Prometheus \u4F53\u73B0\u5982\u56FE</p><p><img src="`+i+`" alt=""></p><h2 id="\u68C0\u67E5\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u68C0\u67E5\u914D\u7F6E" aria-hidden="true">#</a> \u68C0\u67E5\u914D\u7F6E</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> prometheus-2.40.1.darwin-arm64
./promtool check config prometheus.yml
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="\u8FD0\u884C" tabindex="-1"><a class="header-anchor" href="#\u8FD0\u884C" aria-hidden="true">#</a> \u8FD0\u884C</h2><h3 id="\u76F4\u63A5\u8FD0\u884C" tabindex="-1"><a class="header-anchor" href="#\u76F4\u63A5\u8FD0\u884C" aria-hidden="true">#</a> \u76F4\u63A5\u8FD0\u884C</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> prometheus-2.40.1.darwin-arm64
./prometheus
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u8FD9\u6837\u5C31\u76F4\u63A5\u6309\u7167\u9ED8\u8BA4\u53C2\u6570\u8FD0\u884C\u4E86 Prometheus \u670D\u52A1\uFF0C\u8BFB\u53D6\u7684\u914D\u7F6E\u6587\u4EF6\u5C31\u662F\u5F53\u524D\u76EE\u5F55\u4E0B\u7684 prometheus.yml \u9ED8\u8BA4\u914D\u7F6E\u6587\u4EF6</p><h2 id="\u542F\u52A8\u53C2\u6570" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8\u53C2\u6570" aria-hidden="true">#</a> \u542F\u52A8\u53C2\u6570</h2><blockquote><p>\u5217\u4E3E\u4E00\u4E9B\u5E38\u7528\u7684</p></blockquote><ul><li>--config.file=&quot;prometheus.yml&quot; # \u5236\u5B9A\u914D\u7F6E\u6587\u4EF6</li><li>--web.listen-address=&quot;0.0.0.0:9090&quot; # Prometheus \u7684 UI \u5730\u5740</li><li>--web.enable-lifecycle # \u5141\u8BB8\u901A\u8FC7 HTTP \u8BF7\u6C42\u6765\u5173\u95ED\u548C\u91CD\u542F Prometheus \u670D\u52A1</li><li>--storage.tsdb.path=&quot;data/&quot; # metrics \u4FE1\u606F\u5B58\u50A8\u8DEF\u5F84</li><li>--storage.tsdb.retention.time=15d # metrics \u6837\u672C\u5B58\u50A8\u65F6\u957F</li><li>--storage.tsdb.retention.size=512MB # \u6BCF\u4E2A blocks \u7684\u5927\u5C0F</li></ul><h3 id="\u53C2\u6570\u8FD0\u884C" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570\u8FD0\u884C" aria-hidden="true">#</a> \u53C2\u6570\u8FD0\u884C</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./prometheus --config.file<span class="token operator">=</span><span class="token string">&quot;prometheus.yml&quot;</span> <span class="token punctuation">\\</span>
--web.listen-address<span class="token operator">=</span><span class="token string">&quot;0.0.0.0:9090&quot;</span> <span class="token punctuation">\\</span>
--web.enable-lifecycle <span class="token punctuation">\\</span>
--storage.tsdb.retention.time<span class="token operator">=</span>15d <span class="token punctuation">\\</span>
--storage.tsdb.retention.size<span class="token operator">=</span>512MB
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div>`,17);function _(f,y){const a=e("ExternalLinkIcon");return t(),p(r,null,[m,b,s("p",null,[d,s("a",h,[k,l(a)])]),g],64)}var x=c(u,[["render",_]]);export{x as default};
